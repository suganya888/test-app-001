<!DOCTYPE html>
<html lang="en">
<head>
    <!--
    MIT License

    Copyright (c) 2023 The Author

    Permission is hereby granted, free of charge, to any person obtaining a copy
    of this software and associated documentation files (the "Software"), to deal
    in the Software without restriction, including without limitation the rights
    to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
    copies of the Software, and to permit persons to whom the Software is
    furnished to do so, subject to the following conditions:

    The above copyright notice and this permission notice shall be included in all
    copies or substantial portions of the Software.

    THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
    IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
    FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
    AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
    LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
    OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
    SOFTWARE.
    -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Simple Calculator App</title>
    <meta name="description" content="A clean, functional, and minimal single-page calculator application built with HTML, CSS, and JavaScript.">

    <!-- Bootstrap CSS CDN for professional styling -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">

    <style>
        body {
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #f8f9fa; /* Light background */
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 20px;
        }

        .calculator {
            background-color: #343a40; /* Dark background for calculator body */
            border-radius: 10px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.5);
            width: 300px;
            padding: 20px;
            color: #ffffff;
        }

        #calculator-display {
            width: 100%;
            height: 60px;
            background-color: #212529; /* Even darker for display */
            border: none;
            border-radius: 5px;
            margin-bottom: 20px;
            font-size: 2.5em;
            text-align: right;
            padding: 0 15px;
            color: #e9ecef; /* Light grey text */
            box-sizing: border-box;
            pointer-events: none; /* Prevent direct keyboard input on display */
        }

        .calculator-grid {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 10px;
        }

        .calculator-grid button {
            width: 100%;
            height: 60px;
            font-size: 1.5em;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            transition: background-color 0.2s, transform 0.1s;
            color: #ffffff;
            /* Ensure text is centered for all buttons */
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .calculator-grid button:hover {
            transform: scale(1.02);
        }

        .calculator-grid button:active {
            transform: scale(0.98);
        }

        .btn-number, .btn-decimal {
            background-color: #6c757d; /* Grey for numbers */
        }

        .btn-number:hover, .btn-decimal:hover {
            background-color: #5a6268;
        }

        .btn-operator {
            background-color: #ffc107; /* Warning yellow for operators */
            color: #212529;
        }

        .btn-operator:hover {
            background-color: #e0a800;
        }

        #btn-clear {
            background-color: #dc3545; /* Danger red for clear */
        }

        #btn-clear:hover {
            background-color: #c82333;
        }

        #btn-equals {
            background-color: #28a745; /* Success green for equals */
            grid-column: span 4; /* Make equals button span all four columns */
        }

        #btn-equals:hover {
            background-color: #218838;
        }

        /* Responsive adjustments */
        @media (max-width: 400px) {
            .calculator {
                width: 100%;
                border-radius: 0;
                padding: 15px;
            }
            body {
                padding: 0;
            }
        }
    </style>
</head>
<body>
    <div class="calculator">
        <input type="text" id="calculator-display" value="0" readonly>
        <div class="calculator-grid">
            <button id="btn-clear" class="btn-clear">C</button>
            <button id="btn-divide" class="btn-operator" data-operator="/">/</button>
            <button id="btn-multiply" class="btn-operator" data-operator="*">x</button>
            <button id="btn-subtract" class="btn-operator" data-operator="-">-</button>

            <button id="btn-number-7" class="btn-number" data-number="7">7</button>
            <button id="btn-number-8" class="btn-number" data-number="8">8</button>
            <button id="btn-number-9" class="btn-number" data-number="9">9</button>
            <button id="btn-add" class="btn-operator" data-operator="+">+</button>

            <button id="btn-number-4" class="btn-number" data-number="4">4</button>
            <button id="btn-number-5" class="btn-number" data-number="5">5</button>
            <button id="btn-number-6" class="btn-number" data-number="6">6</button>
            <button id="btn-decimal" class="btn-decimal" data-number=".">.</button>

            <button id="btn-number-1" class="btn-number" data-number="1">1</button>
            <button id="btn-number-2" class="btn-number" data-number="2">2</button>
            <button id="btn-number-3" class="btn-number" data-number="3">3</button>
            <button id="btn-number-0" class="btn-number" data-number="0">0</button>

            <button id="btn-equals" class="btn-equals">=</button>
        </div>
    </div>

    <script>
        const display = document.getElementById('calculator-display');
        let currentInput = '0';
        let previousInput = null;
        let operator = null;
        let waitingForSecondOperand = false; // Flag to indicate if the next digit input should clear the display

        function updateDisplay() {
            display.value = currentInput;
        }

        function clear() {
            currentInput = '0';
            previousInput = null;
            operator = null;
            waitingForSecondOperand = false;
            updateDisplay();
        }

        function inputDigit(digit) {
            if (currentInput === 'Error') { // If display shows error, start a new calculation
                currentInput = digit;
                waitingForSecondOperand = false;
            } else if (waitingForSecondOperand) {
                currentInput = digit;
                waitingForSecondOperand = false;
            } else {
                currentInput = currentInput === '0' ? digit : currentInput + digit;
            }
            updateDisplay();
        }

        function inputDecimal() {
            if (currentInput === 'Error') { // If display shows error, start a new calculation with '0.'
                currentInput = '0.';
                waitingForSecondOperand = false;
                updateDisplay();
                return;
            }
            if (waitingForSecondOperand) { // If waiting for second operand, start new number with '0.'
                currentInput = '0.';
                waitingForSecondOperand = false;
                updateDisplay();
                return;
            }
            if (!currentInput.includes('.')) {
                currentInput += '.';
            }
            updateDisplay();
        }

        function calculate(firstOperand, secondOperand, operator) {
            if (operator === '+') {
                return firstOperand + secondOperand;
            } else if (operator === '-') {
                return firstOperand - secondOperand;
            } else if (operator === '*') {
                return firstOperand * secondOperand;
            } else if (operator === '/') {
                if (secondOperand === 0) {
                    return 'Error'; // Indicate division by zero error
                }
                return firstOperand / secondOperand;
            }
            return secondOperand; // Should not be reached with valid operators
        }

        function handleOperator(nextOperator) {
            const inputValue = parseFloat(currentInput);

            if (currentInput === 'Error') { // If in an error state, pressing an operator resets for a new calculation
                previousInput = 0; // Or null, depends on desired behavior. Setting to 0 allows chaining after error.
                currentInput = '0';
                operator = nextOperator;
                waitingForSecondOperand = true;
                updateDisplay();
                return;
            }

            if (operator && waitingForSecondOperand) {
                // If an operator was just pressed and no new number entered, update the operator
                operator = nextOperator;
                return;
            }

            if (previousInput === null) {
                previousInput = inputValue;
            } else if (operator) {
                const result = calculate(previousInput, inputValue, operator);
                if (result === 'Error') {
                    currentInput = 'Error';
                    previousInput = null; // Clear previous input to prevent chaining errors
                    operator = null;
                    waitingForSecondOperand = false;
                    updateDisplay();
                    return;
                }
                currentInput = String(result);
                previousInput = result;
            }

            waitingForSecondOperand = true;
            operator = nextOperator;
            updateDisplay();
        }

        // Initialize display
        updateDisplay();

        // Event delegation for all calculator buttons
        const calculatorGrid = document.querySelector('.calculator-grid');
        calculatorGrid.addEventListener('click', (event) => {
            const { target } = event;

            if (!target.matches('button')) {
                return; // Not a button click
            }

            if (target.id === 'btn-clear') {
                clear();
                return;
            }

            if (target.id === 'btn-decimal') {
                inputDecimal();
                return;
            }

            if (target.id === 'btn-equals') {
                if (operator && previousInput !== null && currentInput !== 'Error') {
                    const result = calculate(previousInput, parseFloat(currentInput), operator);
                    if (result === 'Error') {
                        currentInput = 'Error';
                    } else {
                        currentInput = String(result);
                    }
                    previousInput = null;
                    operator = null;
                    waitingForSecondOperand = false;
                    updateDisplay();
                } else if (currentInput === 'Error') {
                    // If already in an error state, pressing '=' does nothing until 'C' is pressed
                }
                return;
            }

            if (target.classList.contains('btn-operator')) {
                handleOperator(target.dataset.operator);
                return;
            }

            if (target.classList.contains('btn-number')) {
                inputDigit(target.dataset.number);
                return;
            }
        });

        // Optional: Keyboard support
        document.addEventListener('keydown', (event) => {
            const key = event.key;

            if (key >= '0' && key <= '9') {
                inputDigit(key);
            } else if (key === '.') {
                inputDecimal();
            } else if (key === '+' || key === '-' || key === '*' || key === '/') {
                handleOperator(key);
            } else if (key === 'Enter' || key === '=') {
                event.preventDefault(); // Prevent default Enter key behavior (e.g., submitting forms)
                if (operator && previousInput !== null && currentInput !== 'Error') {
                    const result = calculate(previousInput, parseFloat(currentInput), operator);
                    if (result === 'Error') {
                        currentInput = 'Error';
                    } else {
                        currentInput = String(result);
                    }
                    previousInput = null;
                    operator = null;
                    waitingForSecondOperand = false;
                    updateDisplay();
                }
            } else if (key === 'Escape' || key === 'c' || key === 'C') {
                clear();
            } else if (key === 'Backspace') {
                if (currentInput === 'Error') { // If in error state, backspace clears it
                    clear();
                    return;
                }
                if (currentInput.length > 1 && !waitingForSecondOperand) {
                    currentInput = currentInput.slice(0, -1);
                } else {
                    currentInput = '0';
                }
                updateDisplay();
            }
        });
    </script>
</body>
</html>